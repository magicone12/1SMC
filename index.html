<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>TV5 Live</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.7.11/shaka-player.compiled.js"></script>
<style>
html,body{
  margin:0;
  padding:0;
  width:100%;
  height:100%;
  background:#000;
  overflow:hidden;
  font-family:Arial, Helvetica, sans-serif;
}

#startScreen{
  position:fixed;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}

#logoBtn{
  width:140px;
  height:140px;
  border-radius:50%;
  background:#000;
  display:flex;
  align-items:center;
  justify-content:center;
  box-shadow:0 0 20px rgba(255,255,255,.15);
}

#logoBtn img{
  max-width:85%;
  max-height:85%;
}

#videoContainer{
  position:fixed;
  inset:0;
  display:none;
  background:#000;
}

video{
  width:100%;
  height:100%;
  object-fit:contain;
  background:#000;
}

#liveBadge{
  position:absolute;
  top:14px;
  left:14px;
  background:#d00000;
  color:#fff;
  font-size:12px;
  padding:6px 10px;
  border-radius:4px;
  font-weight:bold;
  letter-spacing:.5px;
  display:flex;
  align-items:center;
  gap:6px;
}

#dot{
  width:8px;
  height:8px;
  background:#fff;
  border-radius:50%;
  animation:pulse 1.2s infinite;
}

@keyframes pulse{
  0%{opacity:1}
  50%{opacity:.3}
  100%{opacity:1}
}
</style>
</head>
<body>

<div id="startScreen">
  <div id="logoBtn">
    <img src="https://static.wikia.nocookie.net/russel/images/7/7a/TV5_HD_Logo_2024.png/revision/latest/scale-to-width-down/290?cb=20240202141126" alt="TV5" />
  </div>
</div>

<div id="videoContainer">
  <div id="liveBadge"><span id="dot"></span>LIVE</div>
  <video id="video" autoplay playsinline muted></video>
</div>

<script>
const manifestUri = "https://qp-pldt-live-bpk-02-prod.akamaized.net/bpk-tv/tv5_hd/default1/index.mpd";

const clearKey = {
  "2615129ef2c846a9bbd43a641c7303ef": "07c7f996b1734ea288641a68e1cfdc4d"
};

const startScreen = document.getElementById('startScreen');
const container   = document.getElementById('videoContainer');
const video       = document.getElementById('video');

let player;
let loaded = false;

async function initPlayer() {
  if (loaded) return;

  player = new shaka.Player(video);

  player.configure({
    drm: {
      clearKeys: clearKey
    },
    streaming: {
      lowLatencyMode: true,
      rebufferingGoal: 0.5,
      bufferingGoal: 6
    }
  });

  try {
    await player.load(manifestUri);
    loaded = true;
  } catch (e) {
    console.error('Error loading stream', e);
  }
}

// prepare player as early as possible (para mabilis mag play pag click)
if (shaka.Player.isBrowserSupported()) {
  initPlayer();
}

startScreen.addEventListener('click', async () => {
  startScreen.style.display = 'none';
  container.style.display = 'block';

  try {
    video.muted = false; // play agad with sound dahil may user click
    await video.play();
  } catch (e) {}

  if (container.requestFullscreen) {
    container.requestFullscreen().catch(()=>{});
  } else if (container.webkitRequestFullscreen) {
    container.webkitRequestFullscreen();
  }
});

// totally hide controls
video.controls = false;
</script>
</body>
</html>
